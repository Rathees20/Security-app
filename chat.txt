2025-10-31 13:30
- Topics: Connected VisitHistory, SocietyControl, and AdminControl pages to backend services using new API helper.
- Code: Added src/utils/api.js; updated src/pages/VisitHistory.jsx, src/pages/SocietyControl.jsx, src/pages/AdminControl.jsx.
- Decisions: Store auth token in localStorage for authenticated calls; normalize API responses to tolerate field variations; surface loading/error states in UI.
- Next: Hook up sign-in flow to persist authToken and retest endpoints with valid credentials.

2025-11-14 12:14
- Topics: Replace filter icons across Admin and Society pages.
- Code: Updated imports and UI buttons in src/pages/AdminControl.jsx and src/pages/SocietyControl.jsx to use src/assets/filter.png; no other files touched.
- Decisions: Standardize filter icon via shared asset; keep styling consistent with existing buttons.
- Next: Verify icon appearance in other pages if they add filter controls later.

2025-11-14 14:30
- Topics: Investigated Vercel login 404; adjusted API base URL resolution.
- Code: Updated src/utils/api.js to use production backend URL whenever host isn't localhost/127.0.0.1, keeping /api proxy for local dev.
- Decisions: Default to backend domain in hosted environments; continue honoring VITE_API_BASE_URL overrides.
- Next: Retest login on Vercel deployment and set VITE_API_BASE_URL if future environments need custom hosts.

2025-11-14 14:45
- Topics: Fixed hosted login CORS failure via same-origin proxy strategy.
- Code: src/utils/api.js now always uses /api in browser; added vercel.json rewrite to proxy /api/* to backend domain.
- Decisions: Rely on platform rewrites for deployments while keeping dev proxy in vite.config.
- Next: Deploy with new rewrite and retest login on security-app-iota.vercel.app.

2025-11-14 15:20
- Topics: Resolved admin registration validation errors by supplying required auth fields.
- Code: Updated src/pages/AdminControl.jsx form state, validations, and modal inputs for email/password/role so payload matches backend expectations.
- Decisions: Default role to ADMIN with optional SUPER_ADMIN selection; validate email format and password length before calling /auth/register.
- Next: Retest admin creation end-to-end against backend to ensure successful registration.

2025-11-14 15:40
- Topics: Addressed backend requirements for role casing and confirm password on admin registration.
- Code: Added confirmPassword field + validation, introduced ROLE_OPTIONS with lowercase API values, and ensured payload includes confirmPassword and backend-accepted role strings.
- Decisions: Default role value to `admin`, keep UI labels friendly, surface mismatch errors before API call.
- Next: Re-run admin creation against backend to confirm 200/201 response with new payload.

2025-11-14 16:00
- Topics: Synchronized admin role selector with backend-provided roles to stop invalid submissions.
- Code: Updated src/pages/AdminControl.jsx to derive role options from fetched admins, auto-select a valid role when the modal opens, and fall back to defaults only when no roles are returned.
- Decisions: Prefer backend data for role values; keep UI labels human-readable while submitting exact backend strings.
- Next: Retry admin creation to confirm the newly selected backend role is accepted.

2025-11-14 16:15
- Topics: Restored employee and security guard counts on admin cards.
- Code: Reintroduced employees/securityGuards normalization in src/pages/AdminControl.jsx and rendered SG/E chips in each admin card.
- Decisions: Keep detailed metadata in cards for quick scanning while maintaining minimal payload changes elsewhere.
- Next: Manually verify the counts display for existing admins once data is reloaded.

2025-11-14 16:30
- Topics: Enhanced admin normalization to sniff employee/guard counts from nested backend fields.
- Code: src/pages/AdminControl.jsx now auto-detects numeric values with “employee/guard/security” keywords before falling back to the legacy keys so card stats reflect API data even when field names change.
- Decisions: Use keyword-based scanning to avoid missing data; keep fallback to display-friendly defaults when none found.
- Next: Reload admins and confirm the SG/E badges now mirror backend values.

2025-11-14 16:45
- Topics: Prevented empty/short building names from hitting the backend.
- Code: Added trim + 2–100 char validation for buildingName in src/pages/SocietyControl.jsx and only submits when valid.
- Decisions: Surface validation inline to avoid 400 errors; reuse trimmed value in payload.
- Next: Retry building creation with valid names; consider similar checks for address if backend requires it.

2025-11-14 17:05
- Topics: Structured building address inputs to match backend schema.
- Code: Updated SocietyControl modal/state to capture street/city/state/pincode/country, validate city length, and submit address fields using bracket notation within FormData.
- Decisions: Default country to India, keep optional fields optional, and ensure payload matches BuildingController expectations without overfetching.
- Next: Test building creation with full address to confirm backend accepts the structured payload; extend validations if backend demands more fields.

2025-11-14 17:20
- Topics: Switched SocietyControl submission to JSON when no image to fix backend validation.
- Code: Added shared address payload builder, branched between FormData (with bracket notation) when an image is present and plain JSON otherwise; modal now exposes all address inputs.
- Decisions: Avoid unnecessary multipart requests to keep backend validators happy while still supporting image uploads.
- Next: Retry building creation without an image to confirm the backend accepts the JSON payload; test image uploads afterward.

2025-11-14 17:35
- Topics: Added security-role requirements (building + employee code) to admin creation.
- Code: AdminControl fetches building options when needed, shows conditional inputs, validates them, and includes `buildingId`/`employeeCode` in the payload for security users.
- Decisions: Only load buildings when modal + security role are active; keep other roles unaffected.
- Next: Test creating a security user to ensure backend validations pass.

2025-11-14 17:45
- Topics: Fixed empty building dropdown for security role.
- Code: Expanded AdminControl’s extractArray helper to look for `buildings` and `data.buildings`, ensuring the building fetch populates the select.
- Decisions: Mirror SocietyControl’s extraction logic so all endpoints returning `data.buildings` work consistently.
- Next: Reopen the Add Admin modal with role=Security and confirm building options now appear.

2025-11-17 18:34
- Topics: AWS login 405 investigation and fix.
- Code: Updated src/utils/api.js to fallback to backend origin when /api proxy is absent.
- Decisions: Use /api only on hosts with known rewrites (localhost, 127.*, *.vercel.app); others hit backend directly.
- Next: Retest AWS login; configure VITE_API_BASE_URL if future environments need custom hosts.

2025-01-XX XX:XX
- Topics: Replaced hardcoded backend URLs with environment variable configuration.
- Code: Created .env and .env.example files with VITE_API_BASE_URL; updated src/utils/api.js to use env variable for fallback URL (SSR/server-side); updated vite.config.js to use env variable for proxy target (removes /api suffix automatically); vercel.json still contains hardcoded URL as it's static JSON (Vercel rewrites require manual config or environment-specific deployment settings).
- Decisions: Centralize backend URL configuration via .env file for easier deployment across environments (local, AWS, Vercel); keep fallback to default URL if env variable not set; vite.config proxy extracts base domain from VITE_API_BASE_URL by removing /api suffix.
- Next: Update vercel.json destination URL manually if backend URL changes, or configure per-environment in Vercel dashboard; verify .env file is in .gitignore to avoid committing sensitive configs.
2025-11-17 18:34
- Topics: AWS login 405 investigation and fix.
- Code: Updated src/utils/api.js to fallback to backend origin when /api proxy is absent.
- Decisions: Use /api only on hosts with known rewrites (localhost, 127.*, *.vercel.app); others hit backend directly.
- Next: Retest AWS login; configure VITE_API_BASE_URL if future environments need custom hosts.

2025-01-XX XX:XX
- Topics: Replaced hardcoded backend URLs with environment variable configuration.
- Code: Created .env and .env.example files with VITE_API_BASE_URL; updated src/utils/api.js to use env variable for fallback URL (SSR/server-side); updated vite.config.js to use env variable for proxy target (removes /api suffix automatically); vercel.json still contains hardcoded URL as it's static JSON (Vercel rewrites require manual config or environment-specific deployment settings).
- Decisions: Centralize backend URL configuration via .env file for easier deployment across environments (local, AWS, Vercel); keep fallback to default URL if env variable not set; vite.config proxy extracts base domain from VITE_API_BASE_URL by removing /api suffix.
- Next: Update vercel.json destination URL manually if backend URL changes, or configure per-environment in Vercel dashboard; verify .env file is in .gitignore to avoid committing sensitive configs.
2025-11-17 18:34
- Topics: AWS login 405 investigation and fix.
- Code: Updated src/utils/api.js to fallback to backend origin when /api proxy is absent.
- Decisions: Use /api only on hosts with known rewrites (localhost, 127.*, *.vercel.app); others hit backend directly.
- Next: Retest AWS login; configure VITE_API_BASE_URL if future environments need custom hosts.

2025-01-XX XX:XX
- Topics: Replaced hardcoded backend URLs with environment variable configuration.
- Code: Created .env and .env.example files with VITE_API_BASE_URL; updated src/utils/api.js to use env variable for fallback URL (SSR/server-side); updated vite.config.js to use env variable for proxy target (removes /api suffix automatically); vercel.json still contains hardcoded URL as it's static JSON (Vercel rewrites require manual config or environment-specific deployment settings).
- Decisions: Centralize backend URL configuration via .env file for easier deployment across environments (local, AWS, Vercel); keep fallback to default URL if env variable not set; vite.config proxy extracts base domain from VITE_API_BASE_URL by removing /api suffix.
- Next: Update vercel.json destination URL manually if backend URL changes, or configure per-environment in Vercel dashboard; verify .env file is in .gitignore to avoid committing sensitive configs.

2025-01-XX XX:XX (Follow-up)
- Topics: Fixed CORS error in development - API was calling backend directly instead of using /api proxy.
- Code: Reordered resolveBaseUrl() in src/utils/api.js to check for browser environment first (returns /api) before checking env variable, preventing direct backend calls that cause CORS issues.
- Decisions: Browser requests must always go through /api proxy (vite proxy in dev, vercel rewrite in prod) to avoid CORS; env variable only used for SSR contexts.
- Next: Test login flow in development to confirm CORS issue is resolved.

2025-11-17 18:59
- Topics: AWS deployment support and final configuration summary.
- Code: Updated src/utils/api.js to detect AWS hosts and use VITE_API_BASE_URL for non-localhost/non-Vercel hosts; created DEPLOYMENT.md guide with instructions for Local, Vercel, and AWS deployments.
- Decisions: Smart hostname detection (localhost/127.0.0.1/vercel.app use /api proxy; AWS/other hosts use VITE_API_BASE_URL from env); all pages (AdminControl, VisitHistory, SocietyControl, SignIn) use centralized API utility automatically benefiting from environment-aware configuration.
- Next: Deploy to AWS and set VITE_API_BASE_URL environment variable in AWS deployment environment; verify all API calls work correctly.
